@using Newtonsoft.Json
@{
    ViewBag.Title = "Admin Dashboard";
    var ratingGraph = ViewBag.RatingGraph as List<dynamic> ?? new List<dynamic>();
}

<h2 class="text-warning fw-bold">ğŸ“Š Admin Analytics Dashboard</h2>

<div class="row mt-4">
    <div class="col-md-6">
        <div class="card p-4 text-center">
            <h4>ğŸ‘¥ Total Users</h4>
            <h2 class="text-success">@ViewBag.TotalUsers</h2>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card p-4 text-center">
            <h4>ğŸ“ Total Reviews</h4>
            <h2 class="text-info">@ViewBag.TotalReviews</h2>
        </div>
    </div>
</div>

<h3 class="mt-5 text-info">ğŸ“ˆ Reviews by Rating</h3>
<canvas id="ratingChart" width="400" height="200"></canvas>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const ctx = document.getElementById('ratingChart').getContext('2d');

    const data = {
        labels: @Html.Raw(JsonConvert.SerializeObject(ratingGraph.Select(x => x.Rating))),
        datasets: [{
            label: 'No. of Reviews',
            data: @Html.Raw(JsonConvert.SerializeObject(ratingGraph.Select(x => x.Count))),
            backgroundColor: 'rgba(255, 99, 132, 0.5)',
            borderColor: 'rgba(255, 99, 132, 1)',
            borderWidth: 1
        }]
    };

    new Chart(ctx, {
        type: 'bar',
        data: data,
        options: {
            responsive: true,
            scales: {
                y: { beginAtZero: true }
            }
        }
    });
</script>



